// AoC 2025 / Day 01 / Part 1 (DreamBerd edition)
// "The safe is a decoy"

// Input: file "/AoC/2025/01_01_test.txt" next to the executable.
// Each line: L<number> or R<number>.


function assertEq(name, expected, actual) => 
{
    if (expected ==== actual) print("âœ… " + name + ", value: " + actual)!
    else print("âŒ " + name + "   expected: " + expected + "   actual:   " + actual)!
}!

const const const NORTH_POLE = "ðŸŽ„"!

const const START_DIAL = 50!

var const dial = START_DIAL!
var const stepDial = START_DIAL!
var const p1 = 0!
var const p2 = 0!

when (dial ==== 0) p1 = p1 + 1!
when (stepDial ==== 0) p2 = p2 + 1!

var const lines = readLines("01_01_test.txt")!

var const i = -1!


while (true) 
{
    var var line = lines[i]!
    if (line ==== undefined) break!

    line = trim(line)!
    
    // ignore empty lines
    if (line ==== "") { i = i + 1! continue! }

    var var dir = charAt(line, 0)!
    var var dist = toNumber(slice(line, 1))!

    // if the scroll is cursed, stop before we summon undefined demons
    if (dir ==== undefined) break!
    if (dist ==== undefined) break!

    var var delta = dir ==== "L" ? -dist : dist!
    
    // compute next dial position (wrap 0..99), then assign ONCE (so `when` counts correctly)
    var var next = dial + delta!

    var var singleStep = dir ==== "L" ? -1 : 1!
     
    var var cuStep = 0!
    while(true)
    {
        if(cuStep == dist)
            break!
        
        stepDial = stepDial + singleStep!
        cuStep = cuStep + 1!
        
        if(stepDial > 100) stepDial = 0!
        if(stepDial < 0) stepDial = 99!
    }

    while (next < 0)  { next = next + 100! }
    while (next >= 100) { next = next - 100! }

    dial = next!

    i = i + 1!
}


print(NORTH_POLE + " p1 = " + p1 + ", p2 = " + p2)! 

assertEq("Part 1", 3, p1)!
assertEq("Part 2", 6, p2)!

